{% extends "layouts/PINS.html" %}

{% set pageName="Keyword search" %}

{% set back = true %}

{% block content %}

<script>window.GOVUKFrontend.initAll()</script>

  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">

      <h1 class="govuk-heading-l">Advanced search</h1>

      <form>

        <fieldset id="keyword-group" class="govuk-fieldset">

        {{ govukSelect({
          id: "sort",
          name: "sort",
          label: {
            text: "Document type"
          },
          items: [
            {
              value: "decisions",
              text: "Decision letters"
            }
          ]
        }) }}
          <div class="keyword-criteria">

            <div class="govuk-form-group">
              <label class="govuk-label" for="one-half">
                Look for
              </label>
              <input class="govuk-input govuk-!-width-one-half" id="one-half" name="oneHalf" type="text">
            </div>

          </div>
        </fieldset>

        <button
          type="button"
          id="add-criteria"
          class="govuk-button govuk-button--secondary"
          data-module="govuk-button">
          Add another
        </button>

      </form>

      <h2 class="govuk-heading-m">Publish date range (optional)</h2>
      {{ govukDateInput({
        id: "from",
        namePrefix: "from",
        fieldset: {
          legend: {
            text: "From",
            isPageHeading: false          
          }
        },
        hint: {
          text: "For example, 27 3 2024"
        }
      }) }}

      {{ govukDateInput({
        id: "to",
        namePrefix: "to",
        fieldset: {
          legend: {
            text: "To",
            isPageHeading: false          
          }
        },
        hint: {
          text: "For example, 27 3 2024"
        }
      }) }}

    <div class="moj-button-action">
      {{ govukButton({
        text: "Search",
        href: "search-results"
      }) }}
    </div>

    </div>
  </div>

  <script>
    (function() {
      let count = 1;
      const group = document.getElementById('keyword-group');
      const addBtn = document.getElementById('add-criteria');

      addBtn.addEventListener('click', function() {
        const wrapper = document.createElement('div');
        wrapper.className = 'keyword-criteria';
        wrapper.dataset.index = count;

        wrapper.innerHTML = `
        <div class="govuk-form-group" style="display:flex; gap: 10px; align-items:flex-end;">
          <div>
            <label class="govuk-label" for="condition-${count}">Rule</label>
            <select
              class="govuk-select"
              id="condition-${count}"
              name="condition-${count}"
              style="width: 90px;">
              <option value="And">And</option>
              <option value="Or">Or</option>
              <option value="Not">Not</option>
            </select>
          </div>
          <div class="govuk-form-group">
            <label class="govuk-label" for="keyword-${count}">Look for</label>
            <input class="govuk-input"" id="keyword-${count}" name="keyword-${count}" type="text">
          </div>
          <button
            type="button"
            class="govuk-button govuk-button--secondary remove-criteria"
            data-module="govuk-button"
            style="margin-left:20px; margin-bottom:0;">
            Remove
          </button>
        </div>
      `;

        group.appendChild(wrapper);
        count++;
      });

      group.addEventListener('click', function(e) {
        if (e.target.classList.contains('remove-criteria')) {
          e.target.closest('.keyword-criteria').remove();
        }
      });
    })();
  </script>

{% endblock %}
