{% extends "layouts/bo.html" %}

{% set title = 'Check details and mark enforcement notice as incomplete' %}
{% set pageName = title %}

{% block beforeContent %}
{{ govukBackLink({
text: "Back",
href: 'javascript:history.back()'
}) }}
{% endblock %}

{% block content %}
<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds-from-desktop">

    <span class="govuk-caption-l">Appeal 1223443</span>
    <h1 class="govuk-heading-l">
      {{title}}
    </h1>
    
    {% set groundsHtml %}
  {% if data['grounds'] %}
    <ul class="govuk-list govuk-list--bullet">
      {% for ground in data['grounds'] %}
        {% set reasonKey = "reason" + (ground | replace("Ground ", "")) %}
        {% set reason = data[reasonKey] %}
        {% if reason %}
          <li>{{ ground }}: {{ reason }}</li>
        {% else %}
          <li>{{ ground }}</li>
        {% endif %}
      {% endfor %}
    </ul>
  {% else %}
    <span>No grounds selected</span>
  {% endif %}
{% endset %}

{% set otherInfo = "No" %}
{% if data['otherInformation'] == "Yes" %}
  {% if data['otherInformationText'] %}
    {% set otherInfo = "Yes: " + data['otherInformationText'] %}
  {% else %}
    {% set otherInfo = "Yes" %}
  {% endif %}
{% endif %}

{{ govukSummaryList({
  rows: [
    {
      key: { text: "Review decision" },
      value: { text: "Incomplete" },
      actions: {
        items: [
          { href: "enforcement-appeal", text: "Change", visuallyHiddenText: "review decision" }
        ]
      }
    },
    {
      key: { text: "Why is the appeal incomplete?" },
      value: { text: data['incomplete'] or "Grounds and facts do not match" },
      actions: {
        items: [
          { href: "enforcement-incomplete-reason", text: "Change", visuallyHiddenText: "incomplete reason" }
        ]
      }
    },
    {
      key: { text: "Which grounds do not match the facts?" },
      value: { html: groundsHtml },
      actions: {
        items: [
          { href: "grounds", text: "Change", visuallyHiddenText: "grounds" }
        ]
      }
    },
    {
      key: { text: "Do you want to add any other information?" },
      value: { text: otherInfo },
      actions: {
        items: [
          { href: "enforcement-incomplete-reason", text: "Change", visuallyHiddenText: "incomplete reason" }
        ]
      }
    }
  ]
}) }}

    {{ govukDetails({
    summaryText: "Preview grounds and facts do not match email to the appellant",
    html: '
    <div class="app-email-preview">
      <div class="app-email-preview__subject">
        Subject: We need more information: 1223443
      </div>
      <div class="app-email-preview__body">
        <p class="govuk-body">
          We have reviewed your appeal and we need more information. Your grounds and facts do not match.
        </p>
        <h2 class="govuk-heading-m">
          Appeal details
        </h2>
        <div class="govuk-inset-text">
          Appeal reference number: 1223443<br>
          Address: 22b The Peach Trees, Peckham, SE15 9HA<br>
          Planning application reference: LPA12345678
        </div>
        
        <h2 class="govuk-heading-m">Gounds and facts that do not match</h2>
        
        <h3 class="govuk-heading-s">
          Ground A
        </h3>

        <p class="govuk-body">Location does not match up</p>

        <h2 class="govuk-heading-m">Other information</h2>
        <p class="govuk-body">More information about the grounds and facts</p>


        <h2 class="govuk-heading-m">What happens next</h2>

        <p>Email <a href="mailto:caseofficers@planninginspectorate.gov.uk">
            caseofficers@planninginspectorate.gov.uk</a> to confirm your grounds and facts by 25 November 2025.</p>
        
        <p class="govuk-body">We will cancel your appeal if you do not send the information we need.</p>
        
        <p class="govuk-body"><a href="#">Find out more about grounds and facts</a>.</p>
       
        <p class="govuk-body">Planning Inspectorate</p>

      </div>
    </div>'
    }) }}

    <form method="post">
      {{ govukButton({
      text: "Mark appeal as incomplete"
      }) }}
    </form>

  </div>
</div>
{% endblock %}